<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Inexor Reactive Graph Flow</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="About.html"><strong aria-hidden="true">1.</strong> About</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="About_Design_Goals.html"><strong aria-hidden="true">1.1.</strong> Design Goals</a></li><li class="chapter-item expanded "><a href="About_Roadmap.html"><strong aria-hidden="true">1.2.</strong> Roadmap</a></li></ol></li><li class="chapter-item expanded "><a href="Installation.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="Configuration.html"><strong aria-hidden="true">3.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="Model.html"><strong aria-hidden="true">4.</strong> Model</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Model_Component.html"><strong aria-hidden="true">4.1.</strong> Component</a></li><li class="chapter-item expanded "><a href="Model_Entity_Type.html"><strong aria-hidden="true">4.2.</strong> Entity Type</a></li><li class="chapter-item expanded "><a href="Model_Relation_Type.html"><strong aria-hidden="true">4.3.</strong> Relation Type</a></li><li class="chapter-item expanded "><a href="Model_Entity_Instance.html"><strong aria-hidden="true">4.4.</strong> Entity Instance</a></li><li class="chapter-item expanded "><a href="Model_Relation_Instance.html"><strong aria-hidden="true">4.5.</strong> Relation Instance</a></li><li class="chapter-item expanded "><a href="Model_Flow.html"><strong aria-hidden="true">4.6.</strong> Flow</a></li></ol></li><li class="chapter-item expanded "><a href="GraphQL_API.html"><strong aria-hidden="true">5.</strong> GraphQL API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="GraphQL_API_Components.html"><strong aria-hidden="true">5.1.</strong> Components</a></li><li class="chapter-item expanded "><a href="GraphQL_API_Entity_Types.html"><strong aria-hidden="true">5.2.</strong> Entity Types</a></li><li class="chapter-item expanded "><a href="GraphQL_API_Relation_Types.html"><strong aria-hidden="true">5.3.</strong> Relation Types</a></li><li class="chapter-item expanded "><a href="GraphQL_API_Entity_Instances.html"><strong aria-hidden="true">5.4.</strong> Entity Instances</a></li><li class="chapter-item expanded "><a href="GraphQL_API_Relation_Instances.html"><strong aria-hidden="true">5.5.</strong> Relation Instances</a></li><li class="chapter-item expanded "><a href="GraphQL_API_Flows.html"><strong aria-hidden="true">5.6.</strong> Flows</a></li><li class="chapter-item expanded "><a href="GraphQL_API_Property_Instance_Subscriptions.html"><strong aria-hidden="true">5.7.</strong> Property Instance Subscriptions</a></li></ol></li><li class="chapter-item expanded "><a href="Plugin_System.html"><strong aria-hidden="true">6.</strong> Plugin System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Plugin_System_Component_Provider.html"><strong aria-hidden="true">6.1.</strong> Component Provider</a></li><li class="chapter-item expanded "><a href="Plugin_System_Entity_Type_Provider.html"><strong aria-hidden="true">6.2.</strong> Entity Type Provider</a></li><li class="chapter-item expanded "><a href="Plugin_System_Relation_Type_Provider.html"><strong aria-hidden="true">6.3.</strong> Relation Type Provider</a></li><li class="chapter-item expanded "><a href="Plugin_System_Flow_Provider.html"><strong aria-hidden="true">6.4.</strong> Flow Provider</a></li><li class="chapter-item expanded "><a href="Plugin_System_Component_Provider.html"><strong aria-hidden="true">6.5.</strong> Component Provider</a></li><li class="chapter-item expanded "><a href="Plugin_System_Entity_Behaviour_Provider.html"><strong aria-hidden="true">6.6.</strong> Entity Behaviour Provider</a></li><li class="chapter-item expanded "><a href="Plugin_System_Relation_Behaviour_Provider.html"><strong aria-hidden="true">6.7.</strong> Relation Behaviour Provider</a></li><li class="chapter-item expanded "><a href="Plugin_System_Web_Resource_Provider.html"><strong aria-hidden="true">6.8.</strong> Web Resource Provider</a></li></ol></li><li class="chapter-item expanded "><a href="Development.html"><strong aria-hidden="true">7.</strong> Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Development_Supported_Platforms.html"><strong aria-hidden="true">7.1.</strong> Supported Platforms</a></li><li class="chapter-item expanded "><a href="Development_Build.html"><strong aria-hidden="true">7.2.</strong> Build</a></li><li class="chapter-item expanded "><a href="Development_Coding_Guidelines.html"><strong aria-hidden="true">7.3.</strong> Coding Guidelines</a></li><li class="chapter-item expanded "><a href="Development_Code_Formatting.html"><strong aria-hidden="true">7.4.</strong> Code Formatting</a></li><li class="chapter-item expanded "><a href="Development_Binaries.html"><strong aria-hidden="true">7.5.</strong> Binaries</a></li><li class="chapter-item expanded "><a href="Development_Packaging.html"><strong aria-hidden="true">7.6.</strong> Packaging</a></li><li class="chapter-item expanded "><a href="Development_Documentation.html"><strong aria-hidden="true">7.7.</strong> Documentation</a></li><li class="chapter-item expanded "><a href="Development_License.html"><strong aria-hidden="true">7.8.</strong> License</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Inexor Reactive Graph Flow</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="1-about-inexor"><a class="header" href="#1-about-inexor">1. About Inexor</a></h1>
<ul>
<li>Inexor will be a new first-person shooter game which is based on a new octree-based game engine.</li>
<li>Inexor focuses on classic gameplay as we've seen in Cube2 or the Quake series.</li>
<li>Inexor will be written from ground up new in C++17 and Rust.</li>
<li>You can contribute anything you want: code, content, ideas...</li>
<li>Inexor and all its content is 100% open source!</li>
</ul>
<h2 id="definitions"><a class="header" href="#definitions">Definitions</a></h2>
<h3 id="reactive-behaviour--programming"><a class="header" href="#reactive-behaviour--programming">Reactive (Behaviour / Programming)</a></h3>
<ul>
<li>Every property is a stream not only data</li>
<li>Streams can be subscribed and published</li>
</ul>
<h3 id="graph-semantic--directed--property"><a class="header" href="#graph-semantic--directed--property">Graph (Semantic / Directed / Property)</a></h3>
<p>As first engine of the world Inexor introduces a real graph as foundation of the engine.</p>
<p>Main benefits are:</p>
<ul>
<li>A universal data structure for everything</li>
<li>Relations are first class citizens</li>
<li>Benefit from types and instances which makes things intuitive</li>
<li>Benefit from navigation which is fast and intuitive</li>
<li>Properties can store not only certain primitive data but complete documents</li>
</ul>
<h2 id="flow-control-flow"><a class="header" href="#flow-control-flow">Flow (Control Flow)</a></h2>
<ul>
<li>Connectors connect the properties of entity instances or relation instances</li>
<li>The control flow logic is based on top of the graph (see above) and reactive programming (see above)</li>
<li>Flows will contain most of the logic:
<ul>
<li>game modes will be provided by flows</li>
<li>map logic will be provided by flows</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="11-design-goals"><a class="header" href="#11-design-goals">1.1 Design Goals</a></h1>
<h2 id="plugin-system"><a class="header" href="#plugin-system">Plugin System</a></h2>
<ul>
<li>Small core (outsource most functionality into plugins)</li>
<li>The application needs to be restarted as little as possible</li>
<li>The application has to be changed as seldom as possible</li>
<li>Parts of the application can be reloaded or reloaded</li>
<li>The file size of the application remains small and only what is necessary is required</li>
</ul>
<h2 id="core-application-goals"><a class="header" href="#core-application-goals">Core Application Goals</a></h2>
<ul>
<li>A graph database for managing vertexes (aka entity) and edges (aka relation)</li>
<li>Management of the type system (components, entity, relation)</li>
<li>Management of the instances (entity, relation, flow)</li>
<li>Management of reactive entities (ReactiveEntity, ReactiveRelation, ReactiveFlow)</li>
<li>Management of plugins (configuration via TOML)</li>
<li>Provide a GraphQL interface with access to the type system and the instances</li>
<li>Lifecycle Management</li>
<li>Logging</li>
</ul>
<h2 id="unique-configuration"><a class="header" href="#unique-configuration">Unique configuration</a></h2>
<ul>
<li>Use TOML for configuration wherever possible</li>
<li>The application can be adapted to the needs by configuration. Which plugins are loaded, can be determined. The intended use of the core application is not specified in advance. The core application can be used to implement a wide variety of applications without supplying unnecessary ballast</li>
</ul>
<h2 id="core-application-non-goals"><a class="header" href="#core-application-non-goals">Core Application Non-Goals</a></h2>
<ul>
<li>Commands</li>
<li>Configurations for purposes other than logging, plugins, GraphQL server</li>
<li>System-Variables</li>
<li>Meta data</li>
<li>Implementation of certain reactive behaviors: e.g. logic gates, arithmetic gates</li>
<li>Implementation of game modes, maps, mods</li>
<li>Synchronization</li>
<li>Flow-Editor</li>
<li>Graphics-Rendering</li>
<li>Octree-Editor</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="12-roadmap"><a class="header" href="#12-roadmap">1.2 Roadmap</a></h1>
<p>See <a href="https://github.com/aschaeffer/inexor-rgf-application/milestones">Milestones</a></p>
<ol start="2">
<li>Asset Repository</li>
<li>Audio Devices and Audio Playback</li>
<li>Server-to-server Synchronization</li>
<li>Client-to-server Synchronization</li>
<li>Game Model (Player, Game, Server, Room)</li>
<li>Server/Room Synchronization (S2S)</li>
<li>Server/Room Synchronization (S2C)</li>
<li>Room-Chat</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="2-installation"><a class="header" href="#2-installation">2. Installation</a></h1>
<h2 id="linux"><a class="header" href="#linux">Linux</a></h2>
<h2 id="raspberry-pi"><a class="header" href="#raspberry-pi">Raspberry Pi</a></h2>
<h2 id="windows"><a class="header" href="#windows">Windows</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="3-configuration"><a class="header" href="#3-configuration">3. Configuration</a></h1>
<h2 id="configure-logging"><a class="header" href="#configure-logging">Configure Logging</a></h2>
<ol>
<li>Edit <code>config/logging.toml</code></li>
<li>In the section <code>loggers</code> add or modify the logger for a specific module</li>
</ol>
<pre><code class="language-toml">[loggers.&quot;inexor_rgf_plugin_mqtt::behaviour::relation::mqtt_subscribes&quot;]
level = &quot;debug&quot;
appenders = [ &quot;file-plugin-mqtt&quot; ]
additive = false
</code></pre>
<h2 id="configure-httpgraphql-server"><a class="header" href="#configure-httpgraphql-server">Configure HTTP/GraphQL server</a></h2>
<ol>
<li>Edit <code>config/graphql.toml</code></li>
<li>Configure the hostname and port</li>
</ol>
<pre><code class="language-toml">hostname = &quot;localhost&quot;
port = 31415
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="model"><a class="header" href="#model">Model</a></h1>
<p>TODO: Image Type Model</p>
<p>TODO: Image Instance-&gt;Type Model</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="component"><a class="header" href="#component">Component</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="entity-type"><a class="header" href="#entity-type">Entity Type</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-type"><a class="header" href="#relation-type">Relation Type</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="entity-instance"><a class="header" href="#entity-instance">Entity Instance</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-instance"><a class="header" href="#relation-instance">Relation Instance</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flow"><a class="header" href="#flow">Flow</a></h1>
<h2 id="what-is-a-flow"><a class="header" href="#what-is-a-flow">What is a flow?</a></h2>
<h2 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h2>
<h2 id="wrapper-entity-instance"><a class="header" href="#wrapper-entity-instance">Wrapper Entity Instance</a></h2>
<h2 id="nested-flows"><a class="header" href="#nested-flows">Nested Flows</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphql-api"><a class="header" href="#graphql-api">GraphQL API</a></h1>
<p>GraphQL is the most important interface for interaction with the Reactive Graph Flow.</p>
<p>The GraphQL endpoint can be reached at <code>http://hostname/31415/graphql</code> or <code>ws://hostname/31415/graphql</code>.</p>
<p>The GraphQL schema is well documented.</p>
<h2 id="queries"><a class="header" href="#queries">Queries</a></h2>
<p><img src="images/queries.png" alt="GraphQL Queries" /></p>
<h2 id="mutations"><a class="header" href="#mutations">Mutations</a></h2>
<p><img src="images/mutations.png" alt="GraphQL Mutations" /></p>
<h2 id="subscriptions"><a class="header" href="#subscriptions">Subscriptions</a></h2>
<p><img src="images/subscriptions.png" alt="GraphQL Subscriptions" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="components"><a class="header" href="#components">Components</a></h1>
<h2 id="get-component-by-name"><a class="header" href="#get-component-by-name">Get Component by Name</a></h2>
<pre><code class="language-graphql">query {
  types {
    components(name: &quot;component1&quot;) {
      name
      description
      properties {
        name
        dataType
        socketType
        extensions {
          name
          extension
        }
      }
    }
  }
}
</code></pre>
<h2 id="find-components"><a class="header" href="#find-components">Find Components</a></h2>
<p>Search by name with wildcards (<code>?</code> = single character, <code>*</code> = multiple characters)</p>
<pre><code class="language-graphql">query {
  types {
    components(search: &quot;*player*&quot;) {
      name
      description
      properties {
        name
        dataType
        socketType
      }
    }
  }
}
</code></pre>
<h2 id="create-component"><a class="header" href="#create-component">Create Component</a></h2>
<pre><code class="language-graphql">mutation {
  types {
    components {
      create(
        name: &quot;component1&quot;,
        properties: [
          {
            name: &quot;first&quot;
            description: &quot;First Property&quot;
            dataType: ANY
            socketType: NONE
            extensions: [
              {
                name: &quot;sorted&quot;
                extension: {
                  sortProperty: &quot;first&quot;
                }
              }
            ]
          }
        ]
      ) {
        name
        description
        properties {
          name
          dataType
          socketType
          extensions {
            name
            extension
          }
        }
      }
    }
  }
}
</code></pre>
<h3 id="delete-component"><a class="header" href="#delete-component">Delete Component</a></h3>
<pre><code class="language-graphql">mutation {
  types {
    components {
      delete(name: &quot;component1&quot;)
    }
  }
}
</code></pre>
<h3 id="navigate-from-component-to-entity-types"><a class="header" href="#navigate-from-component-to-entity-types">Navigate from Component to Entity Types</a></h3>
<pre><code class="language-graphql">query {
  types {
    components(name: &quot;component1&quot;) {
      entityTypes {
        name
      }
    }
  }
}
</code></pre>
<h3 id="navigate-from-component-to-relation-types"><a class="header" href="#navigate-from-component-to-relation-types">Navigate from Component to Relation Types</a></h3>
<pre><code class="language-graphql">query {
  types {
    components(name: &quot;component1&quot;) {
      relationTypes {
        name
        fullName
      }
    }
  }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="entity-types"><a class="header" href="#entity-types">Entity Types</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-types"><a class="header" href="#relation-types">Relation Types</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="entity-instances"><a class="header" href="#entity-instances">Entity Instances</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-instances"><a class="header" href="#relation-instances">Relation Instances</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flows"><a class="header" href="#flows">Flows</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="property-instance-subscriptions"><a class="header" href="#property-instance-subscriptions">Property Instance Subscriptions</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="5-plugin-system"><a class="header" href="#5-plugin-system">5. Plugin System</a></h1>
<p>TODO: Introduction</p>
<h2 id="trait-plugin"><a class="header" href="#trait-plugin">Trait <code>Plugin</code></a></h2>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Plugin for ComparisonPluginImpl {

    // ===== Metadata =====

    fn metadata(&amp;self) -&gt; Result&lt;PluginMetadata, PluginError&gt; {}

    // ===== Lifecycle =====

    fn init(&amp;self) -&gt; Result&lt;(), PluginError&gt; {}

    fn post_init(&amp;self) -&gt; Result&lt;(), PluginError&gt; {}

    fn pre_shutdown(&amp;self) -&gt; Result&lt;(), PluginError&gt; {}

    fn shutdown(&amp;self) -&gt; Result&lt;(), PluginError&gt; {}

    // ===== Context =====

    fn set_context(&amp;self, context: Arc&lt;dyn PluginContext&gt;) -&gt; Result&lt;(), PluginError&gt; {}

    // ===== Providers =====
    
    fn get_component_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn ComponentProvider&gt;, PluginError&gt; {}

    fn get_entity_type_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn EntityTypeProvider&gt;, PluginError&gt; {}

    fn get_relation_type_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn RelationTypeProvider&gt;, PluginError&gt; {}

    fn get_component_behaviour_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn ComponentBehaviourProvider&gt;, PluginError&gt; {}

    fn get_entity_behaviour_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn EntityBehaviourProvider&gt;, PluginError&gt; {}

    fn get_relation_behaviour_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn RelationBehaviourProvider&gt;, PluginError&gt; {}

    fn get_flow_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn FlowProvider&gt;, PluginError&gt; {}

    fn get_web_resource_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn WebResourceProvider&gt;, PluginError&gt; {}
}
<span class="boring">}
</span></code></pre></pre>
<h3 id="provide-plugin-metadata"><a class="header" href="#provide-plugin-metadata">Provide plugin metadata</a></h3>
<p>Built-in metadata of the plugin:</p>
<ul>
<li>The name of the plugin (use environment variable <code>CARGO_PKG_NAME</code>)</li>
<li>The description of the plugin (use environment variable <code>CARGO_PKG_DESCRIPTION</code>)</li>
<li>The version of the plugin (use environment variable <code>CARGO_PKG_VERSION</code>)</li>
</ul>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Plugin for ComparisonPluginImpl {
    fn metadata(&amp;self) -&gt; Result&lt;PluginMetadata, PluginError&gt; {
        Ok(PluginMetadata {
            name: env!(&quot;CARGO_PKG_NAME&quot;).into(),
            description: env!(&quot;CARGO_PKG_DESCRIPTION&quot;).into(),
            version: env!(&quot;CARGO_PKG_VERSION&quot;).into(),
        })
    }
}
<span class="boring">}
</span></code></pre></pre>
<h3 id="lifecycle"><a class="header" href="#lifecycle">Lifecycle</a></h3>
<p>The plugin trait provides methods to do initialization and shutdown before and after setting up and shutting down
providers.</p>
<p>TODO: Lifecycle Image</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Plugin for ComparisonPluginImpl {
    fn init(&amp;self) -&gt; Result&lt;(), PluginError&gt; {
        // Called before initialization of the providers
        Ok(())
    }

    fn post_init(&amp;self) -&gt; Result&lt;(), PluginError&gt; {
        // Called after initialization of the providers
        Ok(())
    }

    fn pre_shutdown(&amp;self) -&gt; Result&lt;(), PluginError&gt; {
        // Called before shutdown of the providers
        Ok(())
    }

    fn shutdown(&amp;self) -&gt; Result&lt;(), PluginError&gt; {
        // Called after shutdown of the providers
        Ok(())
    }
}
<span class="boring">}
</span></code></pre></pre>
<h2 id="trait-plugincontext"><a class="header" href="#trait-plugincontext">Trait <code>PluginContext</code></a></h2>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait PluginContext: Send + Sync {
    /// Returns the component manager.
    fn get_component_manager(&amp;self) -&gt; Arc&lt;dyn ComponentManager&gt;;

    /// Returns the entity type manager.
    fn get_entity_type_manager(&amp;self) -&gt; Arc&lt;dyn EntityTypeManager&gt;;

    /// Returns the relation type manager.
    fn get_relation_type_manager(&amp;self) -&gt; Arc&lt;dyn RelationTypeManager&gt;;

    /// Returns the entity instance manager.
    fn get_entity_instance_manager(&amp;self) -&gt; Arc&lt;dyn EntityInstanceManager&gt;;

    /// Returns the relation instance manager.
    fn get_relation_instance_manager(&amp;self) -&gt; Arc&lt;dyn RelationInstanceManager&gt;;

    /// Returns the flow manager.
    fn get_flow_manager(&amp;self) -&gt; Arc&lt;dyn FlowManager&gt;;
}
<span class="boring">}
</span></code></pre></pre>
<h3 id="make-use-of-the-plugin-context"><a class="header" href="#make-use-of-the-plugin-context">Make use of the plugin context</a></h3>
<p>The plugin have to store a reference to the plugin context. Therefore, you have to implement the method <code>set_context</code>
which is called during initialization:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Plugin for ComparisonPluginImpl {
    fn set_context(&amp;self, context: Arc&lt;dyn PluginContext&gt;) -&gt; Result&lt;(), PluginError&gt; {
        self.context.0.write().unwrap().replace(context);
        Ok(())
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>If you want to make use of the <code>EntityInstanceManager</code> you have to:</p>
<ol>
<li>Get a RwLock on the context</li>
<li>Get a reference of the <code>EntityInstanceManager</code> using <code>get_entity_instance_manager</code></li>
<li>Create the entity instance using a builder (non-reactive)</li>
<li>Create/register the entity instance using <code>create</code> returns a reactive entity instance</li>
</ol>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl TestManager {
    fn create_entity(&amp;self) {
        let reader = self.context.0.read().unwrap();
        let entity_instance_manager = reader.as_ref().unwrap().get_entity_instance_manager().clone();
        let entity_instance = EntityInstanceBuilder::new(&quot;entity_type_name&quot;)
            .property(&quot;property_name&quot;, json!(&quot;property_value&quot;))
            .get();
        let reactive_entity_instance = entity_instance_manager.create(entity_instance);
    }
}
<span class="boring">}
</span></code></pre></pre>
<h3 id="implement-or-ignore-providers"><a class="header" href="#implement-or-ignore-providers">Implement or ignore providers</a></h3>
<p>If your plugin provide components you have to return a reference of the <code>ComponentProvider</code>:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Plugin for ComparisonPluginImpl {
    fn get_component_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn ComponentProvider&gt;, PluginError&gt; {
        let component_provider = self.component_provider.clone();
        let component_provider: Result&lt;Arc&lt;dyn ComponentProvider&gt;, _&gt; = &lt;dyn query_interface::Object&gt;::query_arc(component_provider);
        if component_provider.is_err() {
            return Err(PluginError::NoComponentProvider);
        }
        Ok(component_provider.unwrap())
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>If your plugin doesn't provide components:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Plugin for ComparisonPluginImpl {
    fn get_component_provider(&amp;self) -&gt; Result&lt;Arc&lt;dyn ComponentProvider&gt;, PluginError&gt; {
        Err(PluginError::NoComponentProvider)
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>The same applies to all other providers:</p>
<ul>
<li><code>ComponentProvider</code></li>
<li><code>EntityTypeProvider</code></li>
<li><code>RelationTypeProvider</code></li>
<li><code>EntityBehaviourProvider</code></li>
<li><code>RelationBehaviourProvider</code></li>
<li><code>FlowProvider</code></li>
<li><code>WebResourceProvider</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="component-provider"><a class="header" href="#component-provider">Component Provider</a></h1>
<p>Plugins can implement the trait <code>ComponentProvider</code> in order to register components during startup of the </p>
<h2 id="trait-componentprovider"><a class="header" href="#trait-componentprovider">Trait <code>ComponentProvider</code></a></h2>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl ComponentProvider for ComparisonComponentProviderImpl {
    fn get_components(&amp;self) -&gt; Vec&lt;Component&gt; {
        // Return a vector of components
    }
}
<span class="boring">}
</span></code></pre></pre>
<h2 id="use-cases-1"><a class="header" href="#use-cases-1">Use cases</a></h2>
<ul>
<li>Read <code>Component</code>s from external JSON-file from a specific location</li>
<li>Build JSON-file into plugin binary using RustEmbed</li>
<li>Programmatically create <code>Component</code>s</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="entity-type-provider"><a class="header" href="#entity-type-provider">Entity Type Provider</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-type-provider"><a class="header" href="#relation-type-provider">Relation Type Provider</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flow-provider"><a class="header" href="#flow-provider">Flow Provider</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="component-provider-1"><a class="header" href="#component-provider-1">Component Provider</a></h1>
<p>Plugins can implement the trait <code>ComponentProvider</code> in order to register components during startup of the </p>
<h2 id="trait-componentprovider-1"><a class="header" href="#trait-componentprovider-1">Trait <code>ComponentProvider</code></a></h2>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl ComponentProvider for ComparisonComponentProviderImpl {
    fn get_components(&amp;self) -&gt; Vec&lt;Component&gt; {
        // Return a vector of components
    }
}
<span class="boring">}
</span></code></pre></pre>
<h2 id="use-cases-2"><a class="header" href="#use-cases-2">Use cases</a></h2>
<ul>
<li>Read <code>Component</code>s from external JSON-file from a specific location</li>
<li>Build JSON-file into plugin binary using RustEmbed</li>
<li>Programmatically create <code>Component</code>s</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="entity-behaviour-provider"><a class="header" href="#entity-behaviour-provider">Entity Behaviour Provider</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-behaviour-provider"><a class="header" href="#relation-behaviour-provider">Relation Behaviour Provider</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-resource-provider"><a class="header" href="#web-resource-provider">Web Resource Provider</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="7-development"><a class="header" href="#7-development">7. Development</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development--supported-platforms"><a class="header" href="#development--supported-platforms">Development / Supported Platforms</a></h1>
<p>The inexor reactive graph flow is completely platform-agnostic, which allows it to run on various operating systems.</p>
<h3 id="microsoft-windows"><a class="header" href="#microsoft-windows">Microsoft Windows</a></h3>
<p>We support x64 Microsoft Windows 8, 8.1 and 10.</p>
<p>We have build instructions for Windows.</p>
<h3 id="linux-1"><a class="header" href="#linux-1">Linux</a></h3>
<p>We support x64/arm7 Linux.</p>
<p>We have specific build instructions for Ubuntu and Raspberry Pi 2-4.</p>
<p>If you have found a way to set it up for other Linux distributions, please open a pull request and let us know!</p>
<h3 id="macos-and-ios"><a class="header" href="#macos-and-ios">macOS and iOS</a></h3>
<p>We do not support macOS or iOS yet.</p>
<h3 id="android"><a class="header" href="#android">Android</a></h3>
<p>We also do not support Android yet.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development--build"><a class="header" href="#development--build">Development / Build</a></h1>
<h2 id="install-build-tools-rust-and-rustup"><a class="header" href="#install-build-tools-rust-and-rustup">Install build tools (rust and rustup)</a></h2>
<pre><code class="language-shell">curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
</code></pre>
<h2 id="install-nightly-toolchain"><a class="header" href="#install-nightly-toolchain">Install nightly toolchain</a></h2>
<pre><code class="language-shell">rustup update nightly
</code></pre>
<h2 id="clone-the-repository"><a class="header" href="#clone-the-repository">Clone the repository</a></h2>
<pre><code class="language-shell">git clone https://github.com/aschaeffer/inexor-rgf-application.git
</code></pre>
<h2 id="build-the-application"><a class="header" href="#build-the-application">Build the application</a></h2>
<pre><code class="language-shell">cd inexor-rgf-application
cargo build
</code></pre>
<p>Build in release mode:</p>
<pre><code class="language-shell">cd inexor-rgf-application
cargo build --release
</code></pre>
<h2 id="run-the-application"><a class="header" href="#run-the-application">Run the application</a></h2>
<pre><code class="language-shell">cargo run
</code></pre>
<h2 id="build-plugins"><a class="header" href="#build-plugins">Build plugins</a></h2>
<h3 id="checkout-and-build-the-plugin"><a class="header" href="#checkout-and-build-the-plugin">Checkout and build the plugin</a></h3>
<pre><code class="language-shell">cd ..
git clone https://github.com/aschaeffer/inexor-rgf-plugin-mqtt.git
cd inexor-rgf-plugin-mqtt
cargo build
</code></pre>
<p>Build in release mode:</p>
<pre><code class="language-shell">cargo build --release
</code></pre>
<h3 id="configure-plugin"><a class="header" href="#configure-plugin">Configure plugin</a></h3>
<p>Edit <code>config/plugins.toml</code> and add a section for the plugin. The name must match the crate name of the plugin. Specify
the path to the dynamically linked library. The path can be either absolute or relative to the working directory of the
application.</p>
<pre><code class="language-toml">[[plugin]]
name = &quot;inexor-rgf-plugin-mqtt&quot;
active = true
path = &quot;../inexor-rgf-plugin-mqtt/target/debug/libinexor_rgf_plugin_mqtt.so&quot;
</code></pre>
<ul>
<li>Use either a relative or absolute path</li>
<li>The filename of the library is different on windows (inexor_rgf_plugin_mqtt.dll)</li>
<li>Release builds are located in <code>target/release</code> instead of <code>target/debug</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development--coding-guidelines"><a class="header" href="#development--coding-guidelines">Development / Coding Guidelines</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development--code-formatting"><a class="header" href="#development--code-formatting">Development / Code Formatting</a></h1>
<p>We use <code>rustfmt</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development--binary-file-size"><a class="header" href="#development--binary-file-size">Development / Binary File Size</a></h1>
<h2 id="release-profiles"><a class="header" href="#release-profiles">Release Profiles</a></h2>
<ul>
<li>https://doc.rust-lang.org/book/ch14-01-release-profiles.html</li>
</ul>
<pre><code class="language-shell"># Build binary with dev profile
cargo build
</code></pre>
<pre><code class="language-shell"># Build binary with release profile
cargo build --release
</code></pre>
<h2 id="optimization-levels"><a class="header" href="#optimization-levels">Optimization Levels</a></h2>
<ul>
<li>https://doc.rust-lang.org/cargo/reference/profiles.html</li>
</ul>
<h2 id="strip-symbols"><a class="header" href="#strip-symbols">Strip Symbols</a></h2>
<ul>
<li>https://doc.rust-lang.org/cargo/reference/unstable.html#profile-strip-option</li>
</ul>
<h2 id="application-exe"><a class="header" href="#application-exe">Application (exe)</a></h2>
<pre><code class="language-toml">[profile.dev]
opt-level = 0

[profile.release]
opt-level = 3
# 12MB -&gt; 7.8MB
lto = true
# 7.8MB -&gt; 4.5MB
strip = &quot;symbols&quot;
</code></pre>
<h2 id="plugin-sodll"><a class="header" href="#plugin-sodll">Plugin (.so/.dll)</a></h2>
<pre><code class="language-toml">[profile.dev]
opt-level = 0

[profile.release]
opt-level = 3
# 12MB -&gt; 7.8MB
lto = true
# 7.8MB -&gt; 4.5MB
strip = &quot;symbols&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development--packaging"><a class="header" href="#development--packaging">Development / Packaging</a></h1>
<h2 id="cargo-rust-package-manager"><a class="header" href="#cargo-rust-package-manager">cargo (Rust Package Manager)</a></h2>
<pre><code class="language-shell">cargo publish NOT_YET_AVAILABLE
</code></pre>
<h2 id="snap-linux"><a class="header" href="#snap-linux">snap (Linux)</a></h2>
<ul>
<li>https://snapcraft.io/docs/rust-plugin</li>
<li>https://snapcraft.io/docs/snap-confinement</li>
</ul>
<h3 id="configuration-files"><a class="header" href="#configuration-files">Configuration Files</a></h3>
<ul>
<li><code>snapcraft.yaml</code></li>
<li><code>rust-toolchain.toml</code></li>
</ul>
<h3 id="create-package"><a class="header" href="#create-package">Create Package</a></h3>
<pre><code class="language-shell">snapcraft
</code></pre>
<h3 id="install-package"><a class="header" href="#install-package">Install Package</a></h3>
<p>The snap have to be installed with <code>--devmode</code>.</p>
<pre><code class="language-shell">sudo snap install --devmode inexor-rgf-application_0.0.0_amd64.snap
</code></pre>
<h3 id="package-information"><a class="header" href="#package-information">Package Information</a></h3>
<pre><code class="language-shell">snap info --verbose inexor-rgf-application
</code></pre>
<h3 id="snapcraftyaml-examples"><a class="header" href="#snapcraftyaml-examples"><code>snapcraft.yaml</code> Examples</a></h3>
<ul>
<li>https://github.com/lenna-project/lenna-cli/blob/7c31c71d1dd060f0c922b3f8b5e87833b5c45600/snapcraft.yaml</li>
<li>https://github.com/mimblewimble/packaging/blob/af8f34c3a3055be8907a7a2c98cbf63e23e792e3/snap/snapcraft.yaml</li>
</ul>
<h2 id="debian"><a class="header" href="#debian">Debian</a></h2>
<p>(TODO)</p>
<ul>
<li>https://crates.io/crates/cargo-deb</li>
</ul>
<h2 id="rpm"><a class="header" href="#rpm">RPM</a></h2>
<p>(TODO)</p>
<ul>
<li>https://crates.io/crates/cargo-rpm</li>
</ul>
<h2 id="arch"><a class="header" href="#arch">Arch</a></h2>
<p>(TODO)</p>
<ul>
<li>https://crates.io/crates/cargo-arch</li>
</ul>
<h2 id="windows-1"><a class="header" href="#windows-1">(Windows)</a></h2>
<p>(TODO)</p>
<ul>
<li>https://crates.io/crates/msi</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development--documentation"><a class="header" href="#development--documentation">Development / Documentation</a></h1>
<p>We use <a href="https://rust-lang.github.io/mdBook/index.html">mdBook</a> for this documentation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mit-license"><a class="header" href="#mit-license">MIT License</a></h1>
<p>Copyright (c) 2021 Andreas Schaeffer</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
